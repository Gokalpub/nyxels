<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>COSMORA Airdrop</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800&display=swap'); /* Yeni bir bilim kurgu fontu */

        :root {
            --primary: #4B0082; /* Deep Purple */
            --secondary: #8A2BE2; /* Amethyst */
            --accent: #00bcd4; /* Vibrant Cyan */
            --dark: #0a011a; /* Very Dark Purple/Blue */
            --light: #e0e0e0; /* Off-white for text */
            --success: #28a745;
            --info: #17a2b8;
            --warning: #ffc107;
            --danger: #dc3545;
            --gray: #9e9e9e;
            --dark-purple: #3a0050; /* Even deeper purple */
            --cosmic-shard: #FFD700; /* Gold for Cosmic Shards */
            --neon-glow-cyan: 0 0 8px #00bcd4, 0 0 15px #00bcd4; /* Neon glow for accent */
            --neon-glow-purple: 0 0 8px #8A2BE2, 0 0 15px #8A2BE2; /* Neon glow for secondary */
            
            /* Diamond Colors for Animation */
            --diamond-color-1: #00bcd4; /* Cyan */
            --diamond-color-2: #8A2BE2; /* Amethyst */
            --diamond-color-3: #FFD700; /* Gold */
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: radial-gradient(circle at top left, #1a013a, #0a011a 70%); /* More dynamic background */
            color: var(--light);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            touch-action: manipulation;
            overflow-x: hidden;
            position: relative;
        }

        /* Background grid/pattern */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(to right, rgba(255,255,255,0.02) 1px, transparent 1px),
                linear-gradient(to bottom, rgba(255,255,255,0.02) 1px, transparent 1px);
            background-size: 25px 25px;
            z-index: -1;
            opacity: 0.8;
        }
        
        .container {
            max-width: 480px;
            margin: 0 auto;
            padding: 15px;
        }
        
        .header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            padding: 20px;
            text-align: center;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.4), var(--neon-glow-purple); /* Added neon glow */
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }
        
        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .header h1 {
            margin: 0;
            color: white;
            font-size: 28px; /* Larger font size */
            font-weight: 800;
            position: relative;
            text-shadow: 0 0 10px rgba(255,255,255,0.5), 0 0 20px rgba(255,255,255,0.3); /* Stronger shadow */
            font-family: 'Orbitron', sans-serif; /* Sci-fi font */
        }
        
        .header p {
            font-size: 14px;
            opacity: 0.9;
            margin-top: 5px;
            position: relative;
        }
        
        .tab-container {
            display: flex;
            margin-bottom: 20px;
            background-color: rgba(255,255,255,0.08);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2), var(--neon-glow-cyan); /* Added neon glow */
            position: relative;
            z-index: 1;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .tab {
            flex: 1;
            text-align: center;
            padding: 12px 0;
            cursor: pointer;
            color: var(--light);
            font-size: 12px;
            font-weight: 500;
            transition: all 0.3s ease;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }
        
        .tab i {
            font-size: 16px;
        }
        
        .tab.active {
            background-color: var(--accent);
            color: var(--dark);
            font-weight: 600;
            border-bottom: 3px solid var(--light);
            text-shadow: 0 0 5px rgba(255,255,255,0.5); /* Active tab text shadow */
        }
        
        .tab:hover:not(.active) {
            background-color: rgba(255,255,255,0.15);
        }
        
        .tab-badge {
            position: absolute;
            top: 5px;
            right: 5px;
            background-color: var(--danger);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .content {
            background-color: rgba(255,255,255,0.08);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.2), inset 0 0 10px rgba(0,188,212,0.1); /* Inner shadow for content */
            border: 1px solid rgba(255,255,255,0.1);
            display: none;
            position: relative; /* For particle effects */
            overflow: hidden; /* For particle effects */
        }
        
        .content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .click-area {
            background: linear-gradient(135deg, var(--secondary), var(--dark-purple));
            border: 2px solid var(--accent);
            border-radius: 16px;
            padding: 30px;
            text-align: center;
            margin-bottom: 20px;
            cursor: pointer;
            user-select: none;
            box-shadow: 0 10px 20px rgba(0,0,0,0.4), inset 0 0 20px rgba(255,255,255,0.15), var(--neon-glow-cyan); /* Added neon glow */
            transition: transform 0.1s, box-shadow 0.1s;
            position: relative;
            overflow: hidden;
        }
        
        .click-area:active {
            transform: translateY(4px) scale(0.98);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2), inset 0 0 20px rgba(255,255,255,0.1);
        }
        
        .click-area::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .click-area:active::after {
            opacity: 1;
            transform: scale(0);
            transition: transform 0.5s, opacity 0.5s;
        }
        
        /* Diamond Animation with subtle shine and color change */
        .token-icon {
            font-size: 70px; /* Slightly larger icon */
            margin-bottom: 10px;
            /* color: var(--accent); NO direct color for icon, use filter for glow */
            text-shadow: var(--neon-glow-cyan); /* Neon glow for diamond */
            animation: rotateY 8s infinite linear; /* Slower rotation */
            position: relative;
            filter: drop-shadow(0 0 10px var(--accent)); /* Initial drop shadow */
            animation: rotateY 8s infinite linear, token-color-change 5s infinite alternate; /* Combined animations */
        }

        .token-icon::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 70% 30%, rgba(255,255,255,0.5) 0%, transparent 50%);
            filter: blur(5px);
            opacity: 0.5;
            animation: shine 2s infinite ease-in-out;
            border-radius: 50%; /* to contain the radial gradient */
        }

        @keyframes rotateY {
            0% { transform: rotateY(0deg); }
            100% { transform: rotateY(360deg); }
        }

        @keyframes shine {
            0%, 100% { opacity: 0.5; transform: scale(1) translate(0,0); }
            50% { opacity: 0.8; transform: scale(1.1) translate(5px, -5px); }
        }

        @keyframes token-color-change {
            0% { filter: drop-shadow(0 0 10px var(--diamond-color-1)); color: var(--diamond-color-1); }
            33% { filter: drop-shadow(0 0 10px var(--diamond-color-2)); color: var(--diamond-color-2); }
            66% { filter: drop-shadow(0 0 10px var(--diamond-color-3)); color: var(--diamond-color-3); }
            100% { filter: drop-shadow(0 0 10px var(--diamond-color-1)); color: var(--diamond-color-1); }
        }
        
        .click-area:active .token-icon {
            transform: scale(0.9);
            animation-play-state: paused;
        }
        
        .click-reward {
            font-size: 18px; /* Larger click reward text */
            font-weight: 600;
            color: var(--accent);
            margin-top: 10px;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.3s;
            text-shadow: var(--neon-glow-cyan);
        }
        
        .click-area:active .click-reward {
            opacity: 1;
            transform: translateY(0);
        }
        
        .energy-container {
            margin-bottom: 20px;
        }
        
        .energy-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 12px;
            color: var(--gray);
        }
        
        .progress-container {
            width: 100%;
            height: 12px;
            background-color: rgba(255,255,255,0.15);
            border-radius: 6px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.1); /* Border for progress bar */
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--accent), #00e5ff);
            border-radius: 6px;
            width: 0%;
            transition: width 0.5s ease;
            box-shadow: 0 0 8px rgba(0,188,212,0.5); /* Glow for progress bar */
        }
        
        .stat-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background-color: rgba(255,255,255,0.08);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
            border: 1px solid rgba(255,255,255,0.1);
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 10px;
            box-shadow: inset 0 0 0 1px rgba(0,188,212,0.2); /* Subtle inner glow on cards */
            pointer-events: none;
        }
        
        .stat-label {
            font-size: 12px;
            color: var(--gray);
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 20px; /* Larger stat values */
            font-weight: 700;
            color: white;
            text-shadow: 0 0 5px rgba(255,255,255,0.3);
        }
        
        .stat-value span {
            font-size: 14px; /* Larger unit text */
            color: var(--accent);
        }
        
        .button {
            background: linear-gradient(135deg, var(--accent), #00aaff);
            color: var(--dark);
            border: none;
            padding: 12px 20px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            margin: 5px 0;
            width: 100%;
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            border: 1px solid rgba(255,255,255,0.1);
            position: relative;
            overflow: hidden;
        }

        .button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 300%;
            height: 300%;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            transition: all 0.5s ease-out;
            transform: translate(-50%, -50%) scale(0);
            opacity: 0;
        }

        .button:hover::before {
            transform: translate(-50%, -50%) scale(1);
            opacity: 1;
        }
        
        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3), var(--neon-glow-cyan); /* Hover glow */
        }
        
        .button:active {
            transform: translateY(1px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .button.secondary {
            background: linear-gradient(135deg, var(--secondary), var(--primary));
            color: white;
        }
        
        .button.success {
            background: linear-gradient(135deg, var(--success), #1e7e34);
            color: white;
        }
        
        .button.info {
            background: linear-gradient(135deg, var(--info), #117a8b);
            color: white;
        }
        
        .button.warning {
            background: linear-gradient(135deg, var(--warning), #e0a800);
            color: var(--dark);
        }
        
        .button.claimable {
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 4px 6px rgba(0,0,0,0.2); }
            50% { transform: scale(1.02); box-shadow: 0 4px 12px rgba(0,188,212,0.6); }
            100% { transform: scale(1); box-shadow: 0 4px 6px rgba(0,0,0,0.2); }
        }
        
        .section-title {
            font-size: 18px; /* Larger section title */
            font-weight: 700;
            color: var(--accent);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
            text-shadow: var(--neon-glow-cyan); /* Neon glow for title */
            font-family: 'Orbitron', sans-serif;
            text-transform: uppercase;
        }
        
        .section-title i {
            font-size: 20px; /* Larger icon in title */
        }
        
        .quest-card, .earn-card {
            background-color: rgba(255,255,255,0.08);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2), inset 0 0 5px rgba(255,255,255,0.1); /* Inner shadow for cards */
            border: 1px solid rgba(255,255,255,0.1);
            position: relative;
            overflow: hidden;
        }
        
        .quest-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .quest-title {
            font-size: 16px; /* Larger quest title */
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            color: white;
        }
        
        .quest-title i {
            color: var(--accent);
        }
        
        .quest-reward {
            font-size: 16px; /* Larger reward text */
            font-weight: 700;
            color: var(--accent);
            text-shadow: var(--neon-glow-cyan);
        }
        
        .quest-description {
            font-size: 12px;
            color: var(--gray);
            margin-bottom: 10px;
        }
        
        .quest-progress {
            margin-top: 10px;
        }
        
        .quest-progress-text {
            font-size: 11px;
            color: var(--gray);
            margin-top: 5px;
            display: flex;
            justify-content: space-between;
        }
        
        .social-link {
            display: inline-block;
            background-color: rgba(255,255,255,0.15);
            color: white;
            padding: 8px 15px;
            border-radius: 8px;
            font-size: 12px;
            margin-top: 5px;
            text-decoration: none;
            transition: all 0.3s ease;
            border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .social-link:hover {
            background-color: rgba(255,255,255,0.25);
            transform: translateY(-2px);
        }
        
        .social-link i {
            margin-right: 5px;
        }
        
        .inventory-item {
            display: flex;
            align-items: center;
            background-color: rgba(255,255,255,0.08);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
            border: 1px solid rgba(255,255,255,0.1);
            gap: 15px;
        }
        
        .inventory-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--accent), #00e5ff);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: var(--dark);
            flex-shrink: 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
        }
        
        .inventory-info {
            flex: 1;
        }
        
        .inventory-name {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .inventory-description {
            font-size: 12px;
            color: var(--gray);
        }
        
        .inventory-timer {
            font-size: 11px;
            color: var(--accent);
            margin-top: 5px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .profile-card {
            background-color: rgba(255,255,255,0.08);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .profile-info {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .profile-avatar {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--secondary), var(--primary));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 700;
            color: white;
            flex-shrink: 0;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        
        .profile-details {
            flex: 1;
        }
        
        .profile-username {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .profile-referral {
            font-size: 12px;
            color: var(--gray);
            background-color: rgba(255,255,255,0.15);
            padding: 3px 8px;
            border-radius: 4px;
            display: inline-block;
        }
        
        .profile-input {
            width: 100%;
            padding: 12px 15px;
            background-color: rgba(255,255,255,0.15);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 8px;
            color: white;
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            margin-bottom: 10px;
            transition: all 0.3s ease;
        }
        
        .profile-input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 2px rgba(0,188,212,0.3);
        }
        
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, var(--success), #1e7e34);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
            z-index: 1000;
            font-size: 14px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: slideIn 0.3s ease, slideOut 0.3s ease 2.7s forwards;
            max-width: 90%;
            text-align: center;
        }
        
        @keyframes slideIn {
            from { top: -100px; opacity: 0; }
            to { top: 20px; opacity: 1; }
        }
        
        @keyframes slideOut {
            from { top: 20px; opacity: 1; }
            to { top: -100px; opacity: 0; }
        }
        
        .notification i {
            font-size: 18px;
        }
        
        .intro-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--dark), #1a0033);
            z-index: 2000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            animation: fadeOut 1s 3s forwards;
        }
        
        .intro-logo {
            font-size: 32px;
            font-weight: 800;
            color: white;
            margin-bottom: 30px;
            text-align: center;
            background: linear-gradient(90deg, var(--accent), #00e5ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-fill-color: transparent;
            position: relative;
            font-family: 'Orbitron', sans-serif;
            text-shadow: var(--neon-glow-cyan);
        }
        
        .intro-logo::after {
            content: 'Airdrop';
            position: absolute;
            bottom: -20px;
            left: 0;
            width: 100%;
            text-align: center;
            font-size: 14px;
            font-weight: 600;
            color: var(--accent);
            background: none;
            -webkit-text-fill-color: var(--accent);
            text-shadow: none; /* No shadow for smaller text */
        }
        
        .intro-progress {
            width: 80%;
            height: 8px;
            background-color: rgba(255,255,255,0.15);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 30px;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .intro-progress-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, var(--accent), #00e5ff);
            animation: loadProgress 3s forwards;
            box-shadow: 0 0 8px rgba(0,188,212,0.5); /* Glow for intro progress bar */
        }
        
        @keyframes loadProgress {
            0% { width: 0%; }
            100% { width: 100%; }
        }
        
        @keyframes fadeOut {
            0% { opacity: 1; }
            100% { opacity: 0; visibility: hidden; }
        }
        
        .particle {
            position: absolute;
            background-color: var(--accent);
            border-radius: 50%;
            pointer-events: none;
            z-index: 10;
            opacity: 0.7;
            animation: fadeAndShrink 1s forwards;
            box-shadow: 0 0 8px var(--accent);
            transform: translate(-50%, -50%);
        }

        @keyframes fadeAndShrink {
            0% { transform: translate(-50%, -50%) scale(1); opacity: 0.7; }
            100% { transform: translate(-50%, -100px) scale(0); opacity: 0; }
        }
        
        .badge {
            display: inline-block;
            background-color: var(--accent);
            color: var(--dark);
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 700;
            margin-left: 5px;
            vertical-align: middle;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }
        
        .hidden {
            display: none;
        }

        .referral-input-group {
            display: flex;
            align-items: center;
            margin-top: 10px;
            gap: 10px;
        }

        .referral-code-display {
            flex-grow: 1;
            background-color: rgba(255,255,255,0.15);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 8px;
            padding: 12px 15px;
            color: white;
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            text-align: center;
            user-select: all;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.3);
        }

        .copy-button {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
            border: none;
            padding: 12px 15px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .copy-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        .copy-button:active {
            transform: translateY(1px);
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        
        @media (max-width: 400px) {
            .header h1 {
                font-size: 24px; /* Adjust for smaller screens */
            }
            
            .tab {
                font-size: 10px;
                padding: 10px 0;
            }
            
            .tab i {
                font-size: 14px;
            }
            
            .token-icon {
                font-size: 50px;
            }
            
            .stat-value {
                font-size: 16px;
            }
            
            .quest-title {
                font-size: 13px;
            }

            .notification {
                padding: 10px 15px;
                font-size: 12px;
            }

            .section-title {
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="intro-overlay" id="intro-overlay">
        <div class="intro-logo">COSMORA</div>
        <div class="intro-progress">
            <div class="intro-progress-bar"></div>
        </div>
    </div>
    
    <div class="container" id="game-container" style="display: none;">
        <div class="header">
            <h1>COSMORA AIRDROP</h1>
            <p>Mine CSMR tokens and earn rewards!</p>
        </div>
        
        <div class="tab-container">
            <div class="tab active" onclick="switchTab('main')" aria-label="Main Tab">
                <i class="fas fa-home"></i>
                <span>Main</span>
            </div>
            <div class="tab" onclick="switchTab('profile')" aria-label="Profile Tab">
                <i class="fas fa-user"></i>
                <span>Profile</span>
            </div>
            <div class="tab" onclick="switchTab('quests')" aria-label="Quests Tab">
                <i class="fas fa-tasks"></i>
                <span>Quests</span>
                <div class="tab-badge hidden" id="quests-badge"></div>
            </div>
            <div class="tab" onclick="switchTab('earn')" aria-label="Earn Tab">
                <i class="fas fa-hand-holding-usd"></i>
                <span>Earn</span>
                <div class="tab-badge hidden" id="earn-badge"></div>
            </div>
            <div class="tab" onclick="switchTab('inventory')" aria-label="Items Tab">
                <i class="fas fa-box-open"></i>
                <span>Items</span>
                <div class="tab-badge hidden" id="inventory-badge"></div>
            </div>
        </div>
        
        <div id="main-content" class="content active">
            <div class="click-area" id="clicker" onclick="mineToken(event)" aria-label="Mine Tokens Area">
                <div class="token-icon">ðŸ’Ž</div>
                <div style="font-size: 14px; font-weight: 500;">Tap to Mine CSMR</div>
                <div class="click-reward" id="click-reward">+0.05 CSMR</div>
            </div>
            
            <div class="energy-container">
                <div class="energy-header">
                    <span>Energy</span>
                    <span id="energy-label">300/300</span>
                </div>
                <div class="progress-container">
                    <div id="energy-bar" class="progress-bar"></div>
                </div>
            </div>
            
            <div class="stat-grid">
                <div class="stat-card">
                    <div class="stat-label">CSMR Tokens</div>
                    <div class="stat-value" id="token-count">0 <span>CSMR</span></div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">USDT Balance</div>
                    <div class="stat-value" id="usdt-count">0 <span>USDT</span></div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">XP</div>
                    <div class="stat-value" id="xp-count">0 <span>XP</span></div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Level</div>
                    <div class="stat-value" id="level-count">1</div>
                </div>
            </div>
            
            <div class="energy-container">
                <div class="energy-header">
                    <span>Level Progress</span>
                    <span id="xp-label">0/100</span>
                </div>
                <div class="progress-container">
                    <div id="xp-progress" class="progress-bar"></div>
                </div>
            </div>
            
            </div>
        
        <div id="profile-content" class="content">
            <div class="profile-card">
                <div class="profile-info">
                    <div class="profile-avatar" id="profile-avatar">P</div>
                    <div class="profile-details">
                        <div class="profile-username" id="username">Player123</div>
                        <div class="profile-referral" id="referral-code-profile">CSM123</div> </div>
                </div>
                
                <input type="text" id="username-input" placeholder="Enter new username" class="profile-input" aria-label="Change Username">
                <button class="button" onclick="changeUsername()" id="username-button" aria-label="Save Username">
                    <i class="fas fa-save"></i> SAVE USERNAME
                </button>
            </div>
            
            <div class="section-title">
                <i class="fas fa-chart-line"></i> STATISTICS
            </div>
            
            <div class="stat-grid">
                <div class="stat-card">
                    <div class="stat-label">Total Clicks</div>
                    <div class="stat-value" id="total-clicks">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Total Earned</div>
                    <div class="stat-value" id="total-earned">0 <span>CSMR</span></div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Referral Earnings</div>
                    <div class="stat-value" id="referral-earned">0 <span>CSMR</span></div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Play Time</div>
                    <div class="stat-value" id="play-time">0 <span>min</span></div>
                </div>
            </div>
        </div>
        
        <div id="quests-content" class="content">
            <div class="section-title">
                <i class="fas fa-calendar-day"></i> DAILY QUESTS
            </div>
            
            <div class="quest-card">
                <div class="quest-header">
                    <div class="quest-title">
                        <i class="fas fa-mouse-pointer"></i> Click 50 Times
                        <span class="badge hidden" id="quest1-badge">DONE</span>
                    </div>
                    <div class="quest-reward">10 CSMR</div>
                </div>
                <div class="quest-description">Tap the diamond 50 times to complete this quest</div>
                <div class="quest-progress">
                    <div class="progress-container">
                        <div id="quest1-progress" class="progress-bar"></div>
                    </div>
                    <div class="quest-progress-text">
                        <span id="quest1-label">0/50</span>
                        <span>Clicks</span>
                    </div>
                </div>
                <button class="button" onclick="claimQuest(1)" id="quest1-button" aria-label="Claim Click 50 Times Quest">
                    <i class="fas fa-coins"></i> CLAIM REWARD
                </button>
            </div>
            
            <div class="quest-card">
                <div class="quest-header">
                    <div class="quest-title">
                        <i class="fas fa-user-plus"></i> Invite 1 Friend
                        <span class="badge hidden" id="quest2-badge">DONE</span>
                    </div>
                    <div class="quest-reward">25 CSMR</div>
                </div>
                <div class="quest-description">Share your referral link with friends</div>
                <div class="quest-progress">
                    <div class="progress-container">
                        <div id="quest2-progress" class="progress-bar"></div>
                    </div>
                    <div class="quest-progress-text">
                        <span id="quest2-label">0/1</span>
                        <span>Invites</span>
                    </div>
                </div>
                <button class="button" onclick="claimQuest(2)" id="quest2-button" aria-label="Claim Invite 1 Friend Quest">
                    <i class="fas fa-coins"></i> CLAIM REWARD
                </button>
            </div>
            
            <div class="quest-card">
                <div class="quest-header">
                    <div class="quest-title">
                        <i class="fas fa-clock"></i> Play for 3 Hours
                        <span class="badge hidden" id="quest3-badge">DONE</span>
                    </div>
                    <div class="quest-reward">50 CSMR</div>
                </div>
                <div class="quest-description">Stay active in the game for 3 hours</div>
                <div class="quest-progress">
                    <div class="progress-container">
                        <div id="quest3-progress" class="progress-bar"></div>
                    </div>
                    <div class="quest-progress-text">
                        <span id="quest3-label">0/180</span>
                        <span>Minutes</span>
                    </div>
                </div>
                <button class="button" onclick="claimQuest(3)" id="quest3-button" aria-label="Claim Play for 3 Hours Quest">
                    <i class="fas fa-coins"></i> CLAIM REWARD
                </button>
            </div>
            
            <div class="section-title" style="margin-top: 25px;">
                <i class="fas fa-calendar-week"></i> WEEKLY QUESTS
            </div>
            
            <div class="quest-card">
                <div class="quest-header">
                    <div class="quest-title">
                        <i class="fas fa-mouse-pointer"></i> Click 500 Times
                        <span class="badge hidden" id="quest4-badge">DONE</span>
                    </div>
                    <div class="quest-reward">100 CSMR</div>
                </div>
                <div class="quest-description">Tap the diamond 500 times to complete this quest</div>
                <div class="quest-progress">
                    <div class="progress-container">
                        <div id="quest4-progress" class="progress-bar"></div>
                    </div>
                    <div class="quest-progress-text">
                        <span id="quest4-label">0/500</span>
                        <span>Clicks</span>
                    </div>
                </div>
                <button class="button" onclick="claimQuest(4)" id="quest4-button" aria-label="Claim Click 500 Times Quest">
                    <i class="fas fa-coins"></i> CLAIM REWARD
                </button>
            </div>
            
            <div class="quest-card">
                <div class="quest-header">
                    <div class="quest-title">
                        <i class="fas fa-user-plus"></i> Invite 5 Friends
                        <span class="badge hidden" id="quest5-badge">DONE</span>
                    </div>
                    <div class="quest-reward">250 CSMR</div>
                </div>
                <div class="quest-description">Invite 5 friends to join the game</div>
                <div class="quest-progress">
                    <div class="progress-container">
                        <div id="quest5-progress" class="progress-bar"></div>
                    </div>
                    <div class="quest-progress-text">
                        <span id="quest5-label">0/5</span>
                        <span>Invites</span>
                    </div>
                </div>
                <button class="button" onclick="claimQuest(5)" id="quest5-button" aria-label="Claim Invite 5 Friends Quest">
                    <i class="fas fa-coins"></i> CLAIM REWARD
                </button>
            </div>
            
            <div class="section-title" style="margin-top: 25px;">
                <i class="fas fa-users"></i> SOCIAL QUESTS
            </div>
            
            <div class="quest-card">
                <div class="quest-header">
                    <div class="quest-title">
                        <i class="fab fa-twitter"></i> Follow on X
                        <span class="badge hidden" id="quest6-badge">DONE</span>
                    </div>
                    <div class="quest-reward">25 CSMR</div>
                </div>
                <div class="quest-description">Follow our official X (Twitter) account</div>
                <a href="https://x.com/nyxelapp?s=21" target="_blank" class="social-link" onclick="updateQuestsProgress('social', 6)">
                    <i class="fab fa-twitter"></i> Follow @cosmoraapp
                </a>
                <div class="quest-progress">
                    <div class="progress-container">
                        <div id="quest6-progress" class="progress-bar"></div>
                    </div>
                    <div class="quest-progress-text">
                        <span id="quest6-label">0/1</span>
                        <span>Completed</span>
                    </div>
                </div>
                <button class="button" onclick="claimQuest(6)" id="quest6-button" aria-label="Claim Follow on X Quest">
                    <i class="fas fa-coins"></i> CLAIM REWARD
                </button>
            </div>
            
            <div class="quest-card">
                <div class="quest-header">
                    <div class="quest-title">
                        <i class="fab fa-telegram"></i> Join Telegram
                        <span class="badge hidden" id="quest7-badge">DONE</span>
                    </div>
                    <div class="quest-reward">25 CSMR</div>
                </div>
                <div class="quest-description">Join our official Telegram community</div>
                <a href="https://t.me/nyxelofficial" target="_blank" class="social-link" onclick="updateQuestsProgress('social', 7)">
                    <i class="fab fa-telegram"></i> Join Telegram
                </a>
                <div class="quest-progress">
                    <div class="progress-container">
                        <div id="quest7-progress" class="progress-bar"></div>
                    </div>
                    <div class="quest-progress-text">
                        <span id="quest7-label">0/1</span>
                        <span>Completed</span>
                    </div>
                </div>
                <button class="button" onclick="claimQuest(7)" id="quest7-button" aria-label="Claim Join Telegram Quest">
                    <i class="fas fa-coins"></i> CLAIM REWARD
                </button>
            </div>
        </div>

        <div id="earn-content" class="content">
            <div class="section-title">
                <i class="fas fa-calendar-alt"></i> DAILY REWARDS
            </div>
            <div class="earn-card">
                <div class="quest-header">
                    <div class="quest-title">
                        <i class="fas fa-calendar-check"></i> Daily Login Bonus
                    </div>
                    <div class="quest-reward" id="daily-bonus-reward">50 CSMR</div>
                </div>
                <div class="quest-description">Claim your bonus for logging in today!</div>
                <button class="button success" onclick="claimDailyLoginBonus()" id="daily-login-button" aria-label="Claim Daily Login Bonus">
                    <i class="fas fa-gift"></i> CLAIM DAILY BONUS
                </button>
                <div style="font-size: 11px; color: var(--gray); margin-top: 10px;">
                    Next claim available in: <span id="daily-login-timer">Ready!</span>
                </div>
            </div>

            <div class="section-title" style="margin-top: 25px;">
                <i class="fas fa-user-plus"></i> INVITE FRIENDS
            </div>
            <div class="earn-card">
                <div class="quest-header">
                    <div class="quest-title">
                        <i class="fas fa-share-alt"></i> Your Referral Link
                    </div>
                    <div class="quest-reward">Earn 10% of their earnings!</div>
                </div>
                <div class="quest-description">Share this link to invite new players and earn rewards!</div>
                <div class="referral-input-group">
                    <input type="text" id="referral-link-display" class="referral-code-display" readonly>
                    <button class="copy-button" onclick="copyReferralLink()" aria-label="Copy Referral Link">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <div id="inventory-content" class="content">
            <div class="section-title">
                <i class="fas fa-arrow-up"></i> UPGRADES
            </div>
            
            <div class="inventory-item">
                <div class="inventory-icon">
                    <i class="fas fa-bolt"></i>
                </div>
                <div class="inventory-info">
                    <div class="inventory-name">Click Power</div>
                    <div class="inventory-description">Increase tokens earned per click</div>
                    <div class="inventory-timer">
                        <i class="fas fa-level-up-alt"></i> Level: <span id="click-power-level">1</span>
                    </div>
                </div>
                <button class="button" style="padding: 10px 15px; width: auto;" onclick="upgradeClickPower()" id="click-power-cost" aria-label="Upgrade Click Power">
                    <i class="fas fa-coins"></i> <span id="click-power-cost-value">50</span>
                </button>
            </div>
            
            <div class="inventory-item">
                <div class="inventory-icon">
                    <i class="fas fa-battery-full"></i>
                </div>
                <div class="inventory-info">
                    <div class="inventory-name">Max Energy</div>
                    <div class="inventory-description">Increase your maximum energy capacity</div>
                    <div class="inventory-timer">
                        <i class="fas fa-level-up-alt"></i> Level: <span id="max-energy-level">1</span>
                    </div>
                </div>
                <button class="button" style="padding: 10px 15px; width: auto;" onclick="upgradeMaxEnergy()" id="max-energy-cost" aria-label="Upgrade Max Energy">
                    <i class="fas fa-coins"></i> <span id="max-energy-cost-value">200</span>
                </button>
            </div>
        </div>
    </div>
    
    <script>
        // Game Data Structure
        let gameData = {
            tokens: 0,
            xp: 0,
            level: 1,
            nextLevelXp: 100,
            clickPower: 0.05,
            totalClicks: 0,
            totalEarned: 0,
            referralEarned: 0,
            playTime: 0, // In minutes
            energy: { current: 300, max: 300 },
            username: "Player" + Math.floor(Math.random() * 100000),
            usernameLocked: false,
            referralCode: "CSM" + Math.floor(Math.random() * 100000),
            lastDailyLoginClaim: 0, // New property for daily login
            lastDailyReset: 0, // Initialize to 0 for first check
            lastWeeklyReset: 0, // Initialize to 0 for first check
            quests: [
                { id: 1, progress: 0, target: 50, reward: 10, claimed: false, daily: true },
                { id: 2, progress: 0, target: 1, reward: 25, claimed: false, daily: true, track: 'invites' },
                { id: 3, progress: 0, target: 180, reward: 50, claimed: false, daily: true, track: 'playTime' },
                { id: 4, progress: 0, target: 500, reward: 100, claimed: false, weekly: true },
                { id: 5, progress: 0, target: 5, reward: 250, claimed: false, weekly: true, track: 'invites' },
                { id: 6, progress: 0, target: 1, reward: 25, claimed: false, daily: true, track: 'social_x' },
                { id: 7, progress: 0, target: 1, reward: 25, claimed: false, daily: true, track: 'social_telegram' }
            ],
            upgrades: {
                clickPower: 1,
                maxEnergy: 1,
            },
            usdtBalance: 0, // Kept for display, but no swap function
        };

        // Game Initialization
        window.onload = function() {
            setTimeout(() => {
                document.getElementById('intro-overlay').style.display = 'none';
                document.getElementById('game-container').style.display = 'block';
                loadGame();
                checkResetTimers(); // Check and reset quests if needed
                updateUI();
                startPlayTimeCounter();
                startEnergyRegen();
                startDailyLoginTimer(); // Start timer for daily login
                updateBadges();
            }, 3500);
        };
        
        // Save/Load Game Functions
        function saveGame() {
            localStorage.setItem('cosmoraAirdropData', JSON.stringify(gameData));
        }
        
        function loadGame() {
            const savedData = localStorage.getItem('cosmoraAirdropData');
            if (savedData) {
                const parsedData = JSON.parse(savedData);
                // Merge loaded data with default structure to ensure all properties exist
                gameData = {
                    ...gameData,
                    ...parsedData,
                    energy: parsedData.energy || { current: 300, max: 300 },
                    upgrades: parsedData.upgrades || { clickPower: 1, maxEnergy: 1 },
                    // Ensure quests array is deep copied and new quests are added if they exist in default
                    quests: gameData.quests.map(defaultQuest => {
                        const savedQuest = (parsedData.quests || []).find(q => q.id === defaultQuest.id);
                        return savedQuest ? { ...defaultQuest, ...savedQuest } : defaultQuest;
                    }),
                    lastDailyLoginClaim: parsedData.lastDailyLoginClaim || 0,
                    lastDailyReset: parsedData.lastDailyReset || 0,
                    lastWeeklyReset: parsedData.lastWeeklyReset || 0,
                };
                
                updateAvatar();
                
                // Disable username input if locked
                if (gameData.usernameLocked) {
                    document.getElementById('username-input').disabled = true;
                    document.getElementById('username-button').disabled = true;
                }
            }
        }
        
        // Reset Timers
        function checkResetTimers() {
            const now = Date.now();
            
            // Daily reset (24 hours, check if it's a new day)
            const lastDailyDate = new Date(gameData.lastDailyReset);
            const currentDate = new Date(now);

            // Check if current date is different from last daily reset date
            if (currentDate.getDate() !== lastDailyDate.getDate() || 
                currentDate.getMonth() !== lastDailyDate.getMonth() || 
                currentDate.getFullYear() !== lastDailyDate.getFullYear()) {
                
                gameData.quests.forEach(quest => {
                    if (quest.daily) {
                        quest.progress = 0;
                        quest.claimed = false;
                    }
                });
                gameData.lastDailyReset = now; // Update last daily reset timestamp
            }
            
            // Weekly reset (7 days, check if it's a new week - Monday)
            const getMonday = (d) => {
                d = new Date(d);
                const day = d.getDay(),
                    // Adjust diff to get to previous Monday (1 for Monday, 0 for Sunday)
                    diff = d.getDate() - day + (day === 0 ? -6 : 1); 
                const monday = new Date(d.setDate(diff));
                monday.setHours(0, 0, 0, 0); // Set to start of the day
                return monday;
            }

            const lastWeeklyMonday = getMonday(gameData.lastWeeklyReset);
            const currentMonday = getMonday(now);

            if (currentMonday.getTime() !== lastWeeklyMonday.getTime()) {
                gameData.quests.forEach(quest => {
                    if (quest.weekly) {
                        quest.progress = 0;
                        quest.claimed = false;
                    }
                });
                gameData.lastWeeklyReset = now; // Update last weekly reset timestamp
            }
            
            saveGame();
        }

        // UI Update Functions
        function updateUI() {
            // Main stats
            document.getElementById('token-count').textContent = gameData.tokens.toFixed(2);
            document.getElementById('usdt-count').textContent = gameData.usdtBalance.toFixed(4);
            document.getElementById('xp-count').textContent = Math.floor(gameData.xp);
            document.getElementById('level-count').textContent = gameData.level;
            document.getElementById('click-reward').textContent = `+${gameData.clickPower.toFixed(2)} CSMR`;

            // Energy bar
            const energyPercentage = (gameData.energy.current / gameData.energy.max) * 100;
            document.getElementById('energy-bar').style.width = `${energyPercentage}%`;
            document.getElementById('energy-label').textContent = `${Math.floor(gameData.energy.current)}/${gameData.energy.max}`;
            
            // XP bar
            const xpPercentage = (gameData.xp / gameData.nextLevelXp) * 100;
            document.getElementById('xp-progress').style.width = `${Math.min(xpPercentage, 100)}%`;
            document.getElementById('xp-label').textContent = `${Math.floor(gameData.xp)}/${gameData.nextLevelXp}`;
            
            // Profile
            document.getElementById('username').textContent = gameData.username;
            document.getElementById('referral-code-profile').textContent = gameData.referralCode;
            document.getElementById('total-clicks').textContent = gameData.totalClicks;
            document.getElementById('total-earned').textContent = gameData.totalEarned.toFixed(2);
            document.getElementById('referral-earned').textContent = gameData.referralEarned.toFixed(2);
            document.getElementById('play-time').textContent = gameData.playTime;

            // Upgrades
            document.getElementById('click-power-level').textContent = gameData.upgrades.clickPower;
            document.getElementById('max-energy-level').textContent = gameData.upgrades.maxEnergy;

            const clickPowerCost = 50 * Math.pow(1.5, gameData.upgrades.clickPower - 1);
            document.getElementById('click-power-cost-value').textContent = clickPowerCost.toFixed(0);
            const maxEnergyCost = 200 * Math.pow(1.8, gameData.upgrades.maxEnergy - 1);
            document.getElementById('max-energy-cost-value').textContent = maxEnergyCost.toFixed(0);

            // Update quests
            updateQuestsUI();
            updateDailyLoginButton(); // Update daily login button state

            // Update referral link in Earn section
            document.getElementById('referral-link-display').value = `https://t.me/yourgamebot?start=${gameData.referralCode}`;
        }
        
        function updateAvatar() {
            const firstLetter = gameData.username.charAt(0).toUpperCase();
            document.getElementById('profile-avatar').textContent = firstLetter;
        }
        
        function updateQuestsUI() {
            gameData.quests.forEach(quest => {
                const progressBar = document.getElementById(`quest${quest.id}-progress`);
                const progressLabel = document.getElementById(`quest${quest.id}-label`);
                const button = document.getElementById(`quest${quest.id}-button`);
                const badge = document.getElementById(`quest${quest.id}-badge`);
                
                if (!progressBar || !progressLabel || !button || !badge) return;
                
                const progressPercentage = (quest.progress / quest.target) * 100;
                progressBar.style.width = `${Math.min(progressPercentage, 100)}%`;
                progressLabel.textContent = `${Math.floor(quest.progress)}/${quest.target}`;

                if (quest.progress >= quest.target && !quest.claimed) {
                    button.disabled = false;
                    button.classList.add('claimable');
                    badge.classList.remove('hidden');
                    updateBadges();
                } else {
                    button.disabled = true;
                    button.classList.remove('claimable');
                    badge.classList.add('hidden');
                }

                if (quest.claimed) {
                    button.textContent = "CLAIMED";
                    button.disabled = true;
                    button.classList.remove('claimable');
                    badge.classList.remove('hidden');
                    badge.textContent = "DONE";
                    badge.style.backgroundColor = "var(--success)";
                } else {
                    button.textContent = "CLAIM REWARD";
                }
            });
        }

        function updateDailyLoginButton() {
            const button = document.getElementById('daily-login-button');
            const timerSpan = document.getElementById('daily-login-timer');
            const now = Date.now();
            const lastClaim = gameData.lastDailyLoginClaim || 0;
            const msPassed = now - lastClaim;
            const msUntilNextClaim = 24 * 60 * 60 * 1000; // 24 hours in milliseconds

            if (msPassed >= msUntilNextClaim) {
                button.disabled = false;
                button.classList.add('claimable');
                timerSpan.textContent = 'Ready!';
            } else {
                button.disabled = true;
                button.classList.remove('claimable');
                const timeLeft = msUntilNextClaim - msPassed;
                const hours = Math.floor(timeLeft / (1000 * 60 * 60));
                const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
                timerSpan.textContent = `${hours}h ${minutes}m ${seconds}s`;
            }
        }
        
        // Game Logic Functions
        function mineToken(event) {
            if (gameData.energy.current <= 0) {
                showNotification('âš¡ Not enough energy!', 'danger');
                return;
            }
            
            let earned = gameData.clickPower;

            gameData.tokens += earned;
            gameData.totalEarned += earned;
            gameData.xp += 1; // Base XP
            gameData.totalClicks++;
            gameData.energy.current = Math.max(0, gameData.energy.current - 1);

            spawnParticle(event.clientX, event.clientY, `+${earned.toFixed(2)}`);
            updateUI();
            saveGame();
            checkLevelUp();
            updateQuestsProgress('click', 1);
        }

        function checkLevelUp() {
            if (gameData.xp >= gameData.nextLevelXp) {
                gameData.level++;
                gameData.xp -= gameData.nextLevelXp;
                gameData.nextLevelXp = Math.floor(gameData.nextLevelXp * 1.5);
                gameData.energy.max += 50;
                gameData.energy.current = gameData.energy.max;
                showNotification(`ðŸŽ‰ Level Up! You are now Level ${gameData.level}! Energy Refilled!`, 'success');
                updateUI();
                saveGame();
            }
        }
        
        function startEnergyRegen() {
            setInterval(() => {
                if (gameData.energy.current < gameData.energy.max) {
                    gameData.energy.current = Math.min(gameData.energy.max, gameData.energy.current + 0.1); // Base regen rate
                    updateUI();
                    saveGame();
                }
            }, 1000);
        }

        function startPlayTimeCounter() {
            setInterval(() => {
                gameData.playTime++;
                updateUI();
                saveGame();
                updateQuestsProgress('playTime', 1);
            }, 60 * 1000); // Every minute
        }

        function startDailyLoginTimer() {
            setInterval(updateDailyLoginButton, 1000); // Update every second
        }
        
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.classList.add('notification');
            if (type) {
                notification.classList.add(type);
            }
            
            let icon = '';
            if (type === 'success') icon = '<i class="fas fa-check-circle"></i>';
            else if (type === 'danger') icon = '<i class="fas fa-exclamation-circle"></i>';
            else if (type === 'warning') icon = '<i class="fas fa-exclamation-triangle"></i>';
            else icon = '<i class="fas fa-info-circle"></i>';

            notification.innerHTML = `${icon} ${message}`;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        function spawnParticle(x, y, text) {
            const particle = document.createElement('div');
            particle.classList.add('particle');
            particle.textContent = text;
            particle.style.left = `${x}px`;
            particle.style.top = `${y - 20}px`;
            particle.style.fontSize = `${12 + Math.random() * 8}px`;
            particle.style.color = 'white';
            particle.style.textShadow = `0 0 5px white`;
            particle.style.whiteSpace = 'nowrap';
            
            document.body.appendChild(particle);

            const animation = particle.animate([
                { transform: 'translate(-50%, 0)', opacity: 1 },
                { transform: 'translate(-50%, -50px)', opacity: 0 }
            ], {
                duration: 800,
                easing: 'ease-out',
                fill: 'forwards'
            });

            animation.onfinish = () => {
                particle.remove();
            };
        }
        
        function switchTab(tabId) {
            document.querySelectorAll('.content').forEach(content => {
                content.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById(`${tabId}-content`).classList.add('active');
            document.querySelector(`.tab[onclick="switchTab('${tabId}')"]`).classList.add('active');
            updateBadges();
        }

        function updateBadges() {
            let questsClaimable = 0;
            gameData.quests.forEach(quest => {
                if (quest.progress >= quest.target && !quest.claimed) {
                    questsClaimable++;
                }
            });
            document.getElementById('quests-badge').textContent = questsClaimable;
            document.getElementById('quests-badge').classList.toggle('hidden', questsClaimable === 0);

            let earnClaimable = 0;
            const now = Date.now();
            const lastClaim = gameData.lastDailyLoginClaim || 0;
            const msPassed = now - lastClaim;
            const msUntilNextClaim = 24 * 60 * 60 * 1000;
            if (msPassed >= msUntilNextClaim) {
                earnClaimable++;
            }
            document.getElementById('earn-badge').textContent = earnClaimable;
            document.getElementById('earn-badge').classList.toggle('hidden', earnClaimable === 0);
            
            // Inventory badge is currently hidden as there are no dynamic claimable items there
            document.getElementById('inventory-badge').classList.add('hidden');
        }

        function claimDailyLoginBonus() {
            const now = Date.now();
            const lastClaim = gameData.lastDailyLoginClaim || 0;
            const msPassed = now - lastClaim;
            const msUntilNextClaim = 24 * 60 * 60 * 1000; // 24 hours in milliseconds

            if (msPassed >= msUntilNextClaim) {
                const bonusTokens = 50 * gameData.level; // Example: 50 CSMR per level
                gameData.tokens += bonusTokens;
                gameData.lastDailyLoginClaim = now;
                showNotification(`ðŸ’° Claimed ${bonusTokens} CSMR daily login bonus!`, 'success');
                saveGame();
                updateUI();
                updateBadges();
            } else {
                showNotification('â³ Daily login bonus not ready yet!', 'warning');
            }
        }

        function copyReferralLink() {
            const referralLink = document.getElementById('referral-link-display').value;
            navigator.clipboard.writeText(referralLink).then(() => {
                showNotification('ðŸ”— Referral link copied to clipboard!', 'info');
            }).catch(err => {
                console.error('Failed to copy: ', err);
                showNotification('Failed to copy referral link.', 'danger');
            });
            // This would track 1 invite, but you might want to adjust how 'invites' are actually counted.
            // For a real game, this would typically be triggered by a new user joining with the referral code.
            // For now, this is a placeholder.
            // updateQuestsProgress('invite', 1); 
        }

        function changeUsername() {
            const newUsername = document.getElementById('username-input').value.trim();
            if (newUsername.length >= 3 && newUsername.length <= 15) {
                gameData.username = newUsername;
                gameData.usernameLocked = true;
                document.getElementById('username-input').disabled = true;
                document.getElementById('username-button').disabled = true;
                showNotification('âœ… Username updated successfully!', 'success');
                updateAvatar();
                saveGame();
                updateUI();
            } else {
                showNotification('Username must be 3-15 characters long.', 'danger');
            }
        }
        
        function updateQuestsProgress(type, amount = 1) {
            gameData.quests.forEach(quest => {
                if (!quest.claimed) {
                    if (type === 'click' && (quest.id === 1 || quest.id === 4)) {
                        quest.progress += amount;
                    } else if (type === 'invite' && (quest.id === 2 || quest.id === 5)) {
                        // This currently increments on copy referral. For a real app, this should be server-side.
                        quest.progress += amount; 
                    } else if (type === 'playTime' && quest.id === 3) {
                        quest.progress += amount;
                    } else if (type === 'social' && quest.id === 6 && quest.track === 'social_x') {
                        quest.progress = 1; // Social quests are usually boolean (done/not done)
                    } else if (type === 'social' && quest.id === 7 && quest.track === 'social_telegram') {
                        quest.progress = 1; // Social quests are usually boolean (done/not done)
                    }
                }
            });
            saveGame();
            updateQuestsUI();
            updateBadges();
        }

        function claimQuest(questId) {
            const quest = gameData.quests.find(q => q.id === questId);
            if (quest && quest.progress >= quest.target && !quest.claimed) {
                gameData.tokens += quest.reward;
                quest.claimed = true;
                showNotification(`ðŸŽ Claimed ${quest.reward} CSMR for quest!`, 'success');
                saveGame();
                updateUI();
                updateBadges();
            } else {
                showNotification('Quest not completed or already claimed.', 'warning');
            }
        }

        function upgradeClickPower() {
            const cost = 50 * Math.pow(1.5, gameData.upgrades.clickPower - 1);
            if (gameData.tokens >= cost) {
                gameData.tokens -= cost;
                gameData.upgrades.clickPower++;
                gameData.clickPower += 0.05; // Increase click power by 0.05 per upgrade
                showNotification(`âš¡ Click Power upgraded to Level ${gameData.upgrades.clickPower}!`, 'success');
                saveGame();
                updateUI();
            } else {
                showNotification('ðŸ’¸ Not enough CSMR tokens for upgrade!', 'danger');
            }
        }

        function upgradeMaxEnergy() {
            const cost = 200 * Math.pow(1.8, gameData.upgrades.maxEnergy - 1);
            if (gameData.tokens >= cost) {
                gameData.tokens -= cost;
                gameData.upgrades.maxEnergy++;
                gameData.energy.max += 100;
                gameData.energy.current = gameData.energy.max;
                showNotification(`ðŸ”‹ Max Energy upgraded to Level ${gameData.upgrades.maxEnergy}! Energy Refilled!`, 'success');
                saveGame();
                updateUI();
            } else {
                showNotification('ðŸ’¸ Not enough CSMR tokens for upgrade!', 'danger');
            }
        }

        // Auto-save every 10 seconds
        setInterval(saveGame, 10000);
    </script>
</body>
</html>
